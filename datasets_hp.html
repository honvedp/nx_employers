<!doctype html>
<html>
<head>
    <title>Network | Dynamic Data</title>

    <script type="text/javascript" src="lib/vis.js"></script>
	<script src="data/eventsData.js" ></script> 
<!--	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script> -->
	<link href="lib/vis-network.min.css" rel="stylesheet" type="text/css" />
	<link href="lib/bootstrap/css/bootstrap.min.css" rel="stylesheet" media="screen">
	<link href="lib/prettify/prettify.css" rel="stylesheet" media="screen">
    <link rel="stylesheet" href="lib/css/font-awesome.min.css"> 
	<script src="http://code.jquery.com/jquery-1.10.2.min.js"></script>
	<script src="http://code.jquery.com/ui/1.10.3/jquery-ui.min.js"></script>

	<script src="lib/jQAllRangeSliders-min.js"></script>


    <style type="text/css">
        body {
			color: #90A4AE;
            font: 10pt arial;
            background-color: #4B4B4B;
        }	
		
        #mynetwork {
		    height: 500px;
        }
        h4 {
            margin-bottom:3px;
        }
	
    </style>
</head>

http://ghusse.github.io/jQRangeSlider/documentation.html#quickStart
http://ghusse.github.io/jQRangeSlider/technicalDemo.html
   
  <div id="slider-range"></div>

  <div class="wrapper"><div class="sliderZone"><form onsubmit="return false"><div class="ui-rangeSlider ui-rangeSlider-withArrows ui-dateRangeSlider" style="position: relative;"><div class="ui-rangeSlider-container" style="position: absolute; width: 251px;"><div class="ui-rangeSlider-innerBar" style="position: absolute; top: 0px; left: 0px; width: 239px;"></div><div class="ui-rangeSlider-bar" style="position: absolute; top: 0px; width: 125.5px; left: 40.1881px;"></div><div class="ui-rangeSlider-handle ui-rangeSlider-leftHandle" style="position: absolute; top: 0px; left: 40.1944px;"><div class="ui-rangeSlider-handle-inner"></div></div><div class="ui-rangeSlider-handle ui-rangeSlider-rightHandle" style="position: absolute; top: 0px; left: 159.696px;"><div class="ui-rangeSlider-handle-inner"></div></div></div><div class="ui-rangeSlider-arrow ui-rangeSlider-leftArrow" style="position: absolute; left: 0px;"><div class="ui-rangeSlider-arrow-inner"></div></div><div class="ui-rangeSlider-arrow ui-rangeSlider-rightArrow" style="position: absolute; right: 0px;"><div class="ui-rangeSlider-arrow-inner"></div></div><div class="ui-rangeSlider-label ui-rangeSlider-leftLabel" style="position: absolute; display: block; right: 173.313px;"><div class="ui-rangeSlider-label-value">2010-04-27</div><div class="ui-rangeSlider-label-inner"></div></div><div class="ui-rangeSlider-label ui-rangeSlider-rightLabel" style="position: absolute; display: block; right: 54.3125px;"><div class="ui-rangeSlider-label-value">2011-04-27</div><div class="ui-rangeSlider-label-inner"></div></div></div></form></div><div class="logZone"><h3>Events</h3><ol class="log"><li class="valuesChanging">valuesChanging min:2010-02-11 max:2011-02-11</li><li class="valuesChanging">valuesChanging min:2010-02-13 max:2011-02-13</li><li class="valuesChanging">valuesChanging min:2010-02-13 max:2011-02-13</li><li class="valuesChanging">valuesChanging min:2010-02-16 max:2011-02-16</li><li class="valuesChanging">valuesChanging min:2010-02-21 max:2011-02-21</li><li class="valuesChanging">valuesChanging min:2010-03-02 max:2011-03-02</li><li class="valuesChanging">valuesChanging min:2010-03-02 max:2011-03-02</li><li class="valuesChanging">valuesChanging min:2010-03-13 max:2011-03-13</li><li class="valuesChanging">valuesChanging min:2010-03-18 max:2011-03-18</li><li class="valuesChanging">valuesChanging min:2010-03-23 max:2011-03-23</li><li class="valuesChanging">valuesChanging min:2010-03-27 max:2011-03-27</li><li class="valuesChanging">valuesChanging min:2010-03-30 max:2011-03-30</li><li class="valuesChanging">valuesChanging min:2010-04-03 max:2011-04-03</li><li class="valuesChanging">valuesChanging min:2010-04-06 max:2011-04-06</li><li class="valuesChanging">valuesChanging min:2010-04-08 max:2011-04-08</li><li class="valuesChanging">valuesChanging min:2010-04-11 max:2011-04-11</li><li class="valuesChanging">valuesChanging min:2010-04-14 max:2011-04-14</li><li class="valuesChanging">valuesChanging min:2010-04-17 max:2011-04-17</li><li class="valuesChanging">valuesChanging min:2010-04-22 max:2011-04-22</li><li class="valuesChanging">valuesChanging min:2010-04-27 max:2011-04-27</li><li class="valuesChanging">valuesChanging min:2010-05-03 max:2011-05-03</li><li class="valuesChanging">valuesChanging min:2010-05-08 max:2011-05-08</li><li class="valuesChanging">valuesChanging min:2010-05-14 max:2011-05-14</li><li class="valuesChanging">valuesChanging min:2010-05-20 max:2011-05-20</li><li class="valuesChanging">valuesChanging min:2010-05-26 max:2011-05-26</li><li class="valuesChanging">valuesChanging min:2010-05-30 max:2011-05-30</li><li class="valuesChanging">valuesChanging min:2010-06-04 max:2011-06-04</li><li class="valuesChanging">valuesChanging min:2010-06-07 max:2011-06-07</li><li class="valuesChanging">valuesChanging min:2010-06-09 max:2011-06-09</li><li class="valuesChanging">valuesChanging min:2010-06-10 max:2011-06-10</li><li class="valuesChanging">valuesChanging min:2010-06-11 max:2011-06-11</li><li class="valuesChanging">valuesChanging min:2010-06-12 max:2011-06-12</li><li class="valuesChanging">valuesChanging min:2010-06-13 max:2011-06-13</li><li class="valuesChanging">valuesChanging min:2010-06-12 max:2011-06-12</li><li class="valuesChanging">valuesChanging min:2010-06-11 max:2011-06-11</li><li class="valuesChanging">valuesChanging min:2010-06-10 max:2011-06-10</li><li class="valuesChanging">valuesChanging min:2010-06-09 max:2011-06-09</li><li class="valuesChanging">valuesChanging min:2010-06-08 max:2011-06-08</li><li class="valuesChanging">valuesChanging min:2010-06-07 max:2011-06-07</li><li class="valuesChanging">valuesChanging min:2010-06-06 max:2011-06-06</li><li class="valuesChanging">valuesChanging min:2010-06-04 max:2011-06-04</li><li class="valuesChanging">valuesChanging min:2010-06-02 max:2011-06-02</li><li class="valuesChanging">valuesChanging min:2010-06-02 max:2011-06-02</li><li class="valuesChanging">valuesChanging min:2010-06-01 max:2011-06-01</li><li class="valuesChanging">valuesChanging min:2010-05-31 max:2011-05-31</li><li class="valuesChanging">valuesChanging min:2010-05-30 max:2011-05-30</li><li class="valuesChanging">valuesChanging min:2010-05-28 max:2011-05-28</li><li class="valuesChanging">valuesChanging min:2010-05-27 max:2011-05-27</li><li class="valuesChanging">valuesChanging min:2010-05-26 max:2011-05-26</li><li class="valuesChanging">valuesChanging min:2010-05-25 max:2011-05-25</li><li class="valuesChanging">valuesChanging min:2010-05-25 max:2011-05-25</li><li class="valuesChanging">valuesChanging min:2010-05-24 max:2011-05-24</li><li class="valuesChanging">valuesChanging min:2010-05-22 max:2011-05-22</li><li class="valuesChanging">valuesChanging min:2010-05-21 max:2011-05-21</li><li class="valuesChanging">valuesChanging min:2010-05-20 max:2011-05-20</li><li class="valuesChanging">valuesChanging min:2010-05-19 max:2011-05-19</li><li class="valuesChanging">valuesChanging min:2010-05-18 max:2011-05-18</li><li class="valuesChanging">valuesChanging min:2010-05-17 max:2011-05-17</li><li class="valuesChanging">valuesChanging min:2010-05-16 max:2011-05-16</li><li class="valuesChanging">valuesChanging min:2010-05-15 max:2011-05-15</li><li class="valuesChanging">valuesChanging min:2010-05-14 max:2011-05-14</li><li class="valuesChanging">valuesChanging min:2010-05-13 max:2011-05-13</li><li class="valuesChanging">valuesChanging min:2010-05-12 max:2011-05-12</li><li class="valuesChanging">valuesChanging min:2010-05-11 max:2011-05-11</li><li class="valuesChanging">valuesChanging min:2010-05-10 max:2011-05-10</li><li class="valuesChanging">valuesChanging min:2010-05-09 max:2011-05-09</li><li class="valuesChanging">valuesChanging min:2010-05-08 max:2011-05-08</li><li class="valuesChanging">valuesChanging min:2010-05-07 max:2011-05-07</li><li class="valuesChanging">valuesChanging min:2010-05-06 max:2011-05-06</li><li class="valuesChanging">valuesChanging min:2010-05-06 max:2011-05-06</li><li class="valuesChanging">valuesChanging min:2010-05-05 max:2011-05-05</li><li class="valuesChanging">valuesChanging min:2010-05-03 max:2011-05-03</li><li class="valuesChanging">valuesChanging min:2010-05-02 max:2011-05-02</li><li class="valuesChanging">valuesChanging min:2010-05-01 max:2011-05-01</li><li class="valuesChanging">valuesChanging min:2010-04-30 max:2011-04-30</li><li class="valuesChanging">valuesChanging min:2010-04-29 max:2011-04-29</li><li class="valuesChanging">valuesChanging min:2010-04-28 max:2011-04-28</li><li class="valuesChanging">valuesChanging min:2010-04-27 max:2011-04-27</li><li class="valuesChanged">valuesChanged min:2010-04-27 max:2011-04-27</li><li class="userValuesChanged">userValuesChanged min:2010-04-27 max:2011-04-27</li></ol></div></div>

    <div class="sliderContainer">
	<div id="dateSliderExample"></div>
  </div>

<!-- 
<div id="mynetwork"></div>
-->

<script type="text/javascript">


	$(document).ready(function(){
		$("#mynetwork").height((parseInt($(document).height())));
	});


	var gDebug = true;
	var gDelay = 100; // gDelay in ms to add new data points
	var gEmployer = 0;
	var gMaxId = 7;
	var actEventDT;
	var nodeIds = [];
	var edgeIds = [];
	var actNodes = [];
	var actCTs = [];
	
    var /*shadowState, */nodes, edges, network;
	var graph2d, dataset2d;
	var snapshotDs = new vis.DataSet();

	var startDate = new Date('2017-11-08T00:00:00');
	var endDate = new Date('2017-11-08T24:00:00');
	
    createNetwork(); // gráf létrehozása
//	myTrigger();
	loadData();
//	var gTimer = setInterval(myTrigger, gDelay);
	

	function loadData() {
		myLog("loadData - START");	

		for (i = 0; i < employersD.length; i++ ) {
			
			// eventsD végigolvasása, amíg stimmel a dátum
//			for (i = gEvent; i < 13 && eventsD[i].eventDT == snapshotEventDT; i++) { 
/*					upsertNode('un_' + eventsD[i].userName, eventsD[i].userName, 'dot', 'user', snapshotEventDT);
					upsertNode('on_' + eventsD[i].objectName, eventsD[i].objectName, 'dot', 'object', snapshotEventDT);
				
					upsertEdge('un_' + eventsD[i].userName, 'on_' + eventsD[i].objectName);*/

					upsertNode(employersD[i].id, employersD[i].name, employersD[i].name + '</br>(' + employersD[i].email + ')', 'dot', 'user');

				gEmployer ++;
				myLog('eventsD végigolvasása: ' + employersD[i].name);
//			}
		}
	
		// snapshotDs töltése*/
//		snapshotDs.update([{id: snapshotsD[gKor].eventDT, nodes: actNodes.map(x=>x)}]);
      network.fit();
		
	  myLog("loadData - END");	
		
	}

/*	function unsetNodes() {
		for (i = 0; i < actNodes.length; i++) { 
			nodes.update([{id: actNodes[i], group: nodes.get(actNodes[i]).group.substring(3) }]);
		}
		actNodes.length = 0;
	}
	*/
	function upsertNode(pId, pLabel, pTitle, pShape, pGroup){
		if (actNodes.indexOf( pId) < 0){
			actNodes.push(pId);
		};
		
		if (  nodeIds.indexOf( pId) >= 0) {
			var actNode = nodes.get(pId);
		    var pSize = actNode.size + 10;
			if (actNode.group.substring(0, 3) == 'act'){
				nodes.update([{id: pId, size: pSize, icon: {size: pSize}, group: actNode.group}]);
			} else {
				nodes.update([{id: pId, size: pSize, icon: {size: pSize}, group: 'act'+ actNode.group }]);
			}
//			actNode.events.push(snapshotEventDT);
		} else {
			nodes.add({id: pId, /*label: pLabel, */title: pTitle, label: pLabel, shape: pShape, size: 15, icon: {size: 15}, group: 'act'+pGroup/*, events: [snapshotEventDT]*/});
//			nodes.add({id: pId, /*label: pLabel, */title: pLabel, shape: pShape, size: 15, icon: {size: 15}, group: 'user'/*, events: [snapshotEventDT]*/});
			nodeIds.push(pId);
		}
	}

	function upsertEdge(pFrom, pTo){
		var lId = pFrom + ' -> ' + pTo;
		if (  edgeIds.indexOf( lId) >= 0) {
			edges.update([{id: lId, width: edges.get(pFrom + ' -> ' + pTo).width + 1 }]);
		} else {
			edges.add({id: lId, from: pFrom, to: pTo, width: 1});
			edgeIds.push(lId);
		}
	
	}



    function createNetwork() {
        nodes = new vis.DataSet();
        edges = new vis.DataSet();

        // create a network
        var containerN = document.getElementById('mynetwork');
        var data = {
            nodes: nodes,
            edges: edges
        };
        var options = {
			height: '100%',
			width: '100%',
			interaction:{hover:true},
			groups: {
				userGroup: {
					shape: 'icon',
					color: 'gray',
					icon: {
						face: 'FontAwesome',
						code: '\uf0c0',
						color: 'gray',
						}
				},
				actuserGroup: {
					shape: 'icon',
					color: 'rgb(83,186,242)',
					icon: {
						face: 'FontAwesome',
						code: '\uf0c0',
						color: 'rgb(83,186,242)'
						}
				},
				objectOwner: {
					shape: 'icon',
					color: 'gray',
					icon: {
						face: 'FontAwesome',
						code: '\uf0e8',
						color: 'gray'
						}
				},
				actobjectOwner: {
					shape: 'icon',
					color: 'rgb(83,186,242)',
					icon: {
						face: 'FontAwesome',
						code: '\uf0e8',
						color: 'rgb(83,186,242)'
						}
				},
				user: {
					shape: 'icon',
					color: 'gray',
					icon: {
						face: 'FontAwesome',
						code: '\uf007',
//						size: 224,
						color: 'gray'
						}
				},
				actuser: {
					shape: 'icon',
					color: 'rgb(101,200,192)', // vonal - Petrol light
					icon: {
						face: 'FontAwesome',
						code: '\uf007',
						class: 'fa-circle',
						color: 'rgb(33,128,118)' // csomópont - Petrol dark
						}
				},
				object: {
					shape: 'icon',
					color: 'gray',
					icon: {
						face: 'FontAwesome',
						code: '\uf0ce',
						color: 'gray'
						}
				},
				actobject: {
					shape: 'icon',
					color: 'rgb(126,203,245)',	// vonal - Blue light
					icon: {
						face: 'FontAwesome',
						code: '\uf0ce',
						color: 'rgb(49,124,179)' // csomópont - Light blue dark
						}
				},
				
			}
		};
        network = new vis.Network(containerN, data, options);
    }
	
	// debug 
	function myLog(logText){
		if (gDebug == true) {
			console.log(logText);	
		}
	}
	
    function changeOptions() {
        shadowState = !shadowState;
        network.setOptions({nodes:{shadow:shadowState},edges:{shadow:shadowState}});
    }

	function createGraph2d(){
		var container2d = document.getElementById('mygraph2d');
		dataset2d = new vis.DataSet([
				{id: 'workStartDt', x: '2017-11-08T08:00:00', y: 2000, group: 'munkaido', size: 1},  // munkaidő vége
				{id: 'workEndDt', x: '2017-11-08T16:30:00', y: 2000, group: 'munkaido', size: 1}  // munkaidő vége
			]);

		var groups2d = new vis.DataSet([
			{	id: 'munkaido',
				content: 'Munkaidő',
				options: {
					drawPoints: false,
					shaded: {
						orientation: 'bottom', // top, bottom
						className: 'negative'
					}
				}
			},
			{	id: 'user',
				content: 'User',
				options: {
					yAxisOrientation: 'right',
					shaded: false
				}
			},
			{	id: 'object',
				content: 'Object',
				options: {
					shaded: false
				}
			}]);
  
		var options2d = {
			start: startDate /*vis.moment().add(-30, 'seconds')*/,
			end: endDate,
	        moveable: false,
			showMajorLabels: false,
			legend: false, //{right: {position: 'top-left'}},
			height: '150px',
			dataAxis: {
					visible: false,
					showMinorLabels: false,					
					left: {
						range: {
							min: 0, 
							max: 300
							}
						},
					right: {
						range: {
							min: 0, 
							max: 60
							}
						},
					},
			drawPoints: {
				style: 'circle' // square, circle
				},
			format: {
				majorLabels: {
					millisecond:'HH:mm:ss',
					second:     'MM.DD HH:mm',
					minute:     'MM.DD',
					hour:       'YYYY.MM.DD',
					weekday:    'YYYY.MM',
					day:        'YYYY.MM',
					month:      'YYYY',
					year:       ''
				}		
			},
			shaded: {
				orientation: 'bottom' // top, bottom
			}
		};  
		graph2d = new vis.Graph2d(container2d, dataset2d, groups2d, options2d);

		graph2d.addCustomTime(startDate, 't1'); // mutató létrehozása, beállítása a kezdődátumra
		actCTs.push('t1');
	}
	
	
</script>


</body>
</html>
